三方自主福利接口（设计阶段）
===============


## 接入场景

关怀工具可以对接客户自有内部福利系统，以满足客户实现通过关怀工具分发自己内部的特有福利。主要分为以下几步

1. 客户提供对接的场景信息查询。
2. 客户提供领取与查询领取详情落地页。
3. 用户领取完成后，回传领取状态给爱关怀。


## 公用参数与加密方式

请见 [请求签名(v2)](请求签名(v2).md)，其中**partnerId**等同于常见的appid，用于识别请求来源。


## 场景查询

***GET*** https://example-api.com/scene

对接方提供，查询场景信息，返回福利名称、封面、领取截止时间。

**GET参数**


参数 | 必须 | 描述
----|------|----
scene_id	| 是 | 场景ID，代表本次关怀福利场景唯一标识


**返回内容:**
```json
{
    "result": "ok",
    "name": "关爱十周年积分福利",
    "cover": "http://pic.com/cover.png",
    "endtime": "2020-12-31"
}
```

**说明：**

Key      | 必须   | 描述
---      | ---    | ----
result   | 是     | ok表示查询成功
name     | 是     | 福利名称
cover    | 是     | 福利封面图
end_time  | 是     | 领取截止时间


## 领取/已领取的详情落地页

**GET** https://example-api.com/scene/details

对接方提供的福利领取页面或者已领取后的详情页面。该接口根据用户是否已经领取自动路由到领取功能页面或者领取后的详情展示页面。

**GET参数**


参数 | 必须 | 描述
----|------|----
scene_id  |  是 | 场景ID，创建计划时管理员输入。
gcorp_id  |  是  | 点滴关怀方的客户企业ID
guid      |  是  | 点滴关怀方的客户员工ID
member_key |  是  | 双方对接时，由客户提供的员工标识，通常为员工账号
welfare_id  | 是 | 点滴关怀分配的福利ID


**返回**

通常为对接方302跳转至福利功能页面。


## 领取状态确认

**POST** /v1/welfare/receive_confirm

**POST** 参数 


参数 | 必须 | 描述
----|------|----
welfare_id | 是 | 福利ID
state  | 是 | 状态。1未领取；2领取成功。


**返回：**

```json
{
    "errno": 0,
    "body": {
        "result": "ok"
    }
}
```


**说明：**

Key      | 必须   | 描述
---      | ---    | ----
errno   | 是     | 错误号。0无错误。
body.result     | 是     | ok表示操作成功。